<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Tendência Intraday do Dólar</title>

<script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>

<style>
body {
  background:#0e0e0e;
  color:#e0e0e0;
  font-family: Arial, Helvetica, sans-serif;
  margin:20px;
}
h2 { margin-bottom:5px; }
#info { font-size:13px; color:#aaa; margin-bottom:10px; }
#grafico {
  width:100%;
  height:520px;
  background:#111;
  border-radius:6px;
}
</style>
</head>

<body>

<h2>Tendência Intraday do Dólar</h2>
<div id="info">Atualização automática a cada 60 segundos</div>
<div id="grafico"></div>

<script>
const chart = echarts.init(document.getElementById("grafico"));

const ZONA_ALTA = 0.25;
const ZONA_BAIXA = -0.25;

let historico = [];

/* ================================
   GERA SCORE SIMULADO (fallback)
================================ */
function gerarScore() {
  let ultimo = historico.length ? historico[historico.length - 1].score : 0;
  let variacao = (Math.random() - 0.5) * 0.3;
  let novo = Math.max(-1, Math.min(1, ultimo + variacao));
  return Number(novo.toFixed(2));
}

function horaAtual() {
  return new Date().toLocaleTimeString("pt-BR", {
    hour: "2-digit",
    minute: "2-digit"
  });
}

/* ================================
   ATUALIZA GRÁFICO
================================ */
function atualizar() {

  historico.push({
    hora: horaAtual(),
    score: gerarScore()
  });

  if (historico.length > 120) historico.shift();

  chart.setOption({
    backgroundColor: "#111",

    tooltip: {
      trigger: "axis"
    },

    xAxis: {
      type: "category",
      data: historico.map(h => h.hora),
      axisLabel: { color:"#aaa" },
      axisLine: { lineStyle:{ color:"#444" } }
    },

    yAxis: {
      min:-1,
      max:1,
      splitLine:{ lineStyle:{ color:"#222" } },
      axisLabel:{ color:"#aaa" },
      axisLine:{ lineStyle:{ color:"#444" } }
    },

    visualMap: {
      show:false,
      pieces:[
        { gt: ZONA_ALTA, color:"#00c853" },
        { gte: ZONA_BAIXA, lte: ZONA_ALTA, color:"#9e9e9e" },
        { lt: ZONA_BAIXA, color:"#d50000" }
      ]
    },

    series:[{
      type:"line",
      data: historico.map(h => h.score),
      smooth:true,
      symbol:"circle",
      symbolSize:6,
      lineStyle:{ width:2 }
    }]
  });
}

/* ================================
   LOOP TEMPO REAL
================================ */
atualizar();
setInterval(atualizar, 60000);
</script>

</body>
</html>
