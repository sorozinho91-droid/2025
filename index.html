<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>GPS Macro - HistÃ³rico AutomÃ¡tico</title>
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #020617; color: #f8fafc; padding: 20px; }
        .container { max-width: 1100px; margin: 0 auto; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #1e293b; padding-bottom: 10px; }
        #relogio { font-family: monospace; font-size: 1.5rem; color: #60a5fa; }
        .stats { display: flex; gap: 20px; margin-bottom: 20px; }
        .stat-card { flex: 1; background: #0f172a; padding: 15px; border-radius: 12px; border: 1px solid #1e293b; text-align: center; }
        .chart-box { background: #0f172a; border-radius: 12px; padding: 20px; border: 1px solid #1e293b; height: 450px; position: relative; }
        .up { color: #10b981; } .down { color: #ef4444; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ðŸ“Š GPS GLOBAL (01:00 - 00:00)</h1>
        <div id="relogio">00:00:00</div>
    </div>

    <div class="stats">
        <div class="stat-card"><h3>SENTIMENTO</h3><div id="statusSentimento" class="up">MISTO</div></div>
        <div class="stat-card"><h3>FASE ATUAL</h3><div id="faseMercado" style="color: #94a3b8;">--</div></div>
    </div>

    <div class="chart-box">
        <canvas id="meuGrafico"></canvas>
    </div>
</div>

<script>
    let grafico;
    
    // 1. Criar Eixo X de 01:00 atÃ© 00:00
    const labels24h = Array.from({length: 24}, (_, i) => {
        let h = (i + 1) === 24 ? "00" : (i + 1 < 10 ? "0" + (i + 1) : i + 1);
        return h + ":00";
    });

    // 2. Gerar HistÃ³rico Realista atÃ© o momento atual
    function gerarHistorico() {
        const agora = new Date();
        const horaAtual = agora.getHours();
        
        let dadosRisco = [];
        let dadosSeg = [];
        let acumuladoR = 0;
        let acumuladoS = 0;

        for (let i = 1; i <= 24; i++) {
            if (i <= horaAtual || (horaAtual === 0 && i <= 24)) {
                // Simula volatilidade real de 2026
                acumuladoR += (Math.random() * 0.2 - 0.08); 
                acumuladoS += (Math.random() * 0.15 - 0.09);
                dadosRisco.push(acumuladoR.toFixed(2));
                dadosSeg.push(acumuladoS.toFixed(2));
            } else {
                dadosRisco.push(null); // NÃ£o mostra dados do futuro
                dadosSeg.push(null);
            }
        }
        return { dadosRisco, dadosSeg };
    }

    // 3. Inicializar e Atualizar GrÃ¡fico
    function renderizar() {
        const { dadosRisco, dadosSeg } = gerarHistorico();
        const ctx = document.getElementById('meuGrafico').getContext('2d');

        if (grafico) grafico.destroy();

        grafico = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels24h,
                datasets: [
                    { label: 'Risco (Bolsas)', data: dadosRisco, borderColor: '#10b981', backgroundColor: 'rgba(16, 185, 129, 0.1)', fill: true, tension: 0.4 },
                    { label: 'SeguranÃ§a (DÃ³lar)', data: dadosSeg, borderColor: '#ef4444', backgroundColor: 'rgba(239, 68, 68, 0.1)', fill: true, tension: 0.4 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { grid: { color: '#1e293b' }, ticks: { color: '#64748b' } },
                    y: { grid: { color: '#1e293b' }, ticks: { color: '#64748b' } }
                },
                plugins: { legend: { labels: { color: '#f8fafc' } } }
            }
        });
    }

    // 4. Controle de Tempo e Fases
    function loopPrincipal() {
        const agora = new Date();
        const h = agora.getHours();
        document.getElementById('relogio').innerText = agora.toLocaleTimeString('pt-BR');

        // Determinar Fase do Mercado
        let fase = "";
        let status = "";
        if (h >= 1 && h < 9) { fase = "ðŸŒ Ãsia & Europa (Madrugada)"; status = "RISK-OFF (Cautela)"; }
        else if (h >= 9 && h < 18) { fase = "ðŸ‡§ðŸ‡· B3 & ðŸ‡ºðŸ‡¸ EUA (PregÃ£o)"; status = "RISK-ON (Volatilidade)"; }
        else { fase = "ðŸŒ™ After-Market (Fechado)"; status = "ESTÃVEL"; }

        document.getElementById('faseMercado').innerText = fase;
        document.getElementById('statusSentimento').innerText = status;
        document.getElementById('statusSentimento').className = status.includes("ON") ? "up" : "down";
    }

    window.onload = () => {
        renderizar();
        setInterval(renderizar, 60000); // Atualiza grÃ¡fico a cada minuto
        setInterval(loopPrincipal, 1000);
        loopPrincipal();
    };
</script>
</body>
</html>
