<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS de Mercado 2026 - Pressão Técnica</title>
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: #f0f2f5; /* Fundo da página levemente cinza para destacar o gráfico */
            color: #1e293b;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .chart-container { 
            background: #ffffff; /* Fundo interno do gráfico Branco solicitado */
            border: 1px solid #e2e8f0; 
            border-radius: 16px; 
            padding: 24px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            height: 500px;
        }
        #relogio { font-size: 1.5rem; font-weight: bold; color: #2563eb; text-align: center; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div id="relogio">00:00:00</div>
        <div class="chart-container">
            <canvas id="marketChart"></canvas>
        </div>
    </div>

    <script>
        let marketChart;
        let acumuladoRisco = 0;
        let acumuladoSeguranca = 0;
        let pressaoSeguranca = 0;

        function initChart() {
            const ctx = document.getElementById('marketChart').getContext('2d');
            marketChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: 'Ativos de Risco',
                            borderColor: '#10b981', // Verde
                            data: [],
                            fill: false, tension: 0, pointRadius: 0
                        },
                        {
                            label: 'Ativos de Segurança',
                            borderColor: '#ef4444', // Vermelho
                            data: [],
                            fill: false, tension: 0, pointRadius: 0
                        },
                        {
                            label: 'Pressão Segurança (Direção)', // TERCEIRA LINHA ADICIONADA
                            borderColor: '#f59e0b', // Laranja
                            borderDash: [5, 5], // Tracejada para distinguir
                            data: [],
                            fill: false, tension: 0.1, pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { grid: { color: '#f1f5f9' } },
                        x: { grid: { display: false } }
                    }
                }
            });
        }

        function engine() {
            const agora = new Date(new Date().toLocaleString("en-US", {timeZone: "America/Sao_Paulo"}));
            const h = agora.getHours();
            const timestamp = agora.toLocaleTimeString('pt-BR');
            document.getElementById('relogio').textContent = timestamp;

            // Filtro de Horário: 01:00 às 18:00
            if (h >= 1 && h < 18) {
                let variacaoSeg = (Math.random() - 0.5) * 0.2;
                
                acumuladoRisco += (Math.random() - 0.49) * 0.15;
                acumuladoSeguranca += variacaoSeg;
                
                // CÁLCULO DA LINHA DE PRESSÃO:
                // Ela amplifica a variação atual para mostrar a aceleração da direção
                pressaoSeguranca = acumuladoSeguranca + (variacaoSeg * 10);

                marketChart.data.labels.push(timestamp);
                marketChart.data.datasets[0].data.push(acumuladoRisco.toFixed(2));
                marketChart.data.datasets[1].data.push(acumuladoSeguranca.toFixed(2));
                marketChart.data.datasets[2].data.push(pressaoSeguranca.toFixed(2));

                marketChart.update('none');
            }
        }

        window.onload = () => {
            initChart();
            setInterval(engine, 3000); // Atualiza a cada 3 segundos
        };
    </script>
</body>
</html>
