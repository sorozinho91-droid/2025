<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dire√ß√£o Macro ‚Äì Mini √çndice B3</title>

<style>
body{font-family:Arial;margin:0;background:#f4f6f8}
header{background:#020617;color:#fff;padding:12px;text-align:center}
#relogio{text-align:center;margin:18px 0;font-size:18px;font-weight:bold}
#conteudo{width:720px;margin:0 auto}

/* ===== DIRE√á√ÉO MACRO ===== */
#macroBox{
 padding:26px;border-radius:14px;
 box-shadow:0 8px 22px rgba(0,0,0,.25);
 text-align:center;margin-bottom:18px;
 transition:all .4s;
}
.titulo{font-size:13px;letter-spacing:1px;opacity:.7}
.direcao{font-size:42px;font-weight:bold;margin:12px 0}
.acao{font-size:16px;font-weight:bold}

.verde{background:linear-gradient(135deg,#dcfce7,#bbf7d0);color:#065f46}
.vermelho{background:linear-gradient(135deg,#fee2e2,#fecaca);color:#7f1d1d}
.neutro{background:linear-gradient(135deg,#fef9c3,#fde68a);color:#713f12}

.piscar{animation:pisc 1s infinite}
@keyframes pisc{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}

/* ===== NOT√çCIAS MACRO ===== */
#newsMacro{background:#0f172a;color:#fff;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,.35)}
#newsMacro h3{margin:0;padding:12px;background:#020617;text-align:center;border-radius:12px 12px 0 0}
.newsItem{padding:12px;border-bottom:1px solid #1e293b;font-size:13px}
.newsItem a{color:#93c5fd;text-decoration:none}

/* ===== BREAKING NEWS (N√ÉO ALTERADO) ===== */
#painel-news{
 position:fixed;top:28px;right:10px;width:360px;
 background:#111827;color:white;border-radius:6px;
 box-shadow:0 4px 8px rgba(0,0,0,0.3);z-index:9998
}
.news-header{text-align:center;font-weight:bold;padding:8px;background:#1f2937}
#newsList{max-height:260px;overflow-y:auto;font-size:13px}
.news-item{padding:8px;border-bottom:1px solid #374151}
.news-item a{color:#93c5fd;text-decoration:none}
</style>
</head>

<body>

<header>
  <h2>Dire√ß√£o Macro do Mercado ‚Äì Mini √çndice (WIN)</h2>
</header>

<div id="relogio"></div>

<div id="conteudo">

  <div id="macroBox" class="neutro">
    Carregando leitura macro...
  </div>

  <div id="newsMacro">
    <h3>üì∞ Not√≠cias Macro Relevantes</h3>
    <div id="newsMacroList">
      <div class="newsItem">Aguardando not√≠cias...</div>
    </div>
  </div>

</div>

<!-- BREAKING NEWS INTACTO -->
<div id="painel-news">
  <div class="news-header">üö® BREAKING NEWS ‚Äì Macro</div>
  <div id="newsList">
    <div class="news-item">Aguardando not√≠cias...</div>
  </div>
</div>

<audio id="somMacro" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
// ===== REL√ìGIO BRAS√çLIA =====
setInterval(()=>{
 const d=new Date(),u=d.getTime()+d.getTimezoneOffset()*60000;
 relogio.innerText="‚è∞ Hor√°rio de Bras√≠lia: "+new Date(u-3*3600000).toLocaleTimeString("pt-BR");
},1000);

// ===== BUSCAR PRE√áOS (TradingView) =====
async function tvPrice(symbol){
 const url=`https://api.allorigins.win/raw?url=https://s3.tradingview.com/symbols/${symbol.replace(":","_")}.json`;
 try{
  const r=await fetch(url);
  const j=await r.json();
  return j.last_price||j.close||0;
 }catch(e){return 0;}
}

let prev={sp:0,vix:0,dxy:0,di:0},ultimo="";

// ===== DIRE√á√ÉO MACRO GLOBAL + BRASIL =====
async function atualizarMacro(){
 const sp=await tvPrice("INDEX:SPX");        // S&P 500
 const vix=await tvPrice("CBOE:VIX");        // Volatilidade
 const dxy=await tvPrice("FOREXCOM:DX1!");   // D√≥lar
 const di=await tvPrice("BMFBOVESPA:DI1!");  // DI Futuro Brasil

 if(!sp||!vix||!dxy||!di) return;

 const spVar=(sp-prev.sp)/prev.sp||0;
 const vixVar=(vix-prev.vix)/prev.vix||0;
 const dxyVar=(dxy-prev.dxy)/prev.dxy||0;
 const diVar=(di-prev.di)/prev.di||0;

 prev={sp,vix,dxy,di};

 let estado="NEUTRO",acao="Aguardar",classe="neutro";

 const riscoOn = spVar>0 && vixVar<0 && diVar<0;
 const riscoOff = spVar<0 && vixVar>0 && diVar>0;

 if(riscoOn){
   estado="ALTA";
   acao="Global + Brasil favor√°veis ‚Üí Priorizar COMPRAS no WIN";
   classe="verde";
 }
 else if(riscoOff){
   estado="BAIXA";
   acao="Avers√£o ao risco + Juros abrindo ‚Üí Priorizar VENDAS no WIN";
   classe="vermelho";
 }
 else{
   estado="NEUTRO";
   acao="Conflito macro ‚Üí Defesa / Reduzir exposi√ß√£o";
   classe="neutro";
 }

 if(ultimo && ultimo!==estado){
   somMacro.play().catch(()=>{});
   macroBox.classList.add("piscar");
   setTimeout(()=>macroBox.classList.remove("piscar"),9000);
 }
 ultimo=estado;

 macroBox.className=classe;
 macroBox.innerHTML=`
  <div class="titulo">Dire√ß√£o Macro (SP500 ‚Ä¢ VIX ‚Ä¢ DXY ‚Ä¢ DI Futuro)</div>
  <div class="direcao">${estado}</div>
  <div class="acao">${acao}</div>
 `;
}
setInterval(atualizarMacro,60000);
atualizarMacro();
</script>

</body>
</html>
