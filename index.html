<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Direção Intraday - Segurança Brasil x Mundo</title>
<script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
<style>
body {
  background:#0e0e0e;
  color:#e0e0e0;
  font-family:Arial, Helvetica, sans-serif;
  margin:20px;
}
#grafico {
  width:100%;
  height:520px;
  background:#111;
  border-radius:8px;
}
</style>
</head>
<body>

<h2>Direção Intraday - Segurança Brasil x Mundo</h2>
<p>Atualização a cada 60s • Histórico intraday</p>

<div id="grafico"></div>

<script>
const chart = echarts.init(document.getElementById("grafico"));

// Histórico intraday
let eixoX = [];
let valorBrasil = 0;
let valorMundo = 0;
let historicoBrasil = [];
let historicoMundo = [];

/* =========================
   Simula direção do dia
========================= */
async function pegarDirecaoBrasil(){
    // Simulação: USD-BRL + Ouro-BRL
    return (Math.random()*0.002 - 0.001) + (Math.random()*0.002 - 0.001);
}

async function pegarDirecaoMundo(){
    // Simulação: XAU-USD + DXY
    return (Math.random()*0.002 - 0.001) + (Math.random()*0.002 - 0.001);
}

/* =========================
   Atualiza gráfico intraday
========================= */
async function atualizarGrafico(){
    const hora = new Date().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
    eixoX.push(hora);
    if(eixoX.length>480) eixoX.shift();

    // Atualiza direção acumulada
    valorBrasil += await pegarDirecaoBrasil();
    valorMundo += await pegarDirecaoMundo();
    historicoBrasil.push(valorBrasil);
    historicoMundo.push(valorMundo);
    if(historicoBrasil.length>480){ historicoBrasil.shift(); historicoMundo.shift(); }

    // Atualiza gráfico
    chart.setOption({
        backgroundColor:"#111",
        tooltip:{trigger:"axis", formatter: params=>{
            return params.map(p=>`${p.seriesName}: ${(p.data*100).toFixed(2)}%`).join("<br>");
        }},
        legend:{data:["Segurança Brasil","Segurança Mundo"], textStyle:{color:"#ccc"}},
        xAxis:{type:"category", data:eixoX, axisLabel:{color:"#aaa"}},
        yAxis:{scale:true, axisLabel:{formatter:v=>(v*100).toFixed(2)+"%", color:"#aaa"}, splitLine:{lineStyle:{color:"#222"}}},
        series:[
            {name:"Segurança Brasil", type:"line", smooth:true, showSymbol:false, data:historicoBrasil, lineStyle:{width:2,type:"dashed",color:"#00c853"}},
            {name:"Segurança Mundo", type:"line", smooth:true, showSymbol:false, data:historicoMundo, lineStyle:{width:2,color:"#d50000"}}
        ]
    });
}

// Inicializa loop automático
atualizarGrafico();
setInterval(atualizarGrafico,60000);
</script>

</body>
</html>

