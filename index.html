<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dire√ß√£o Macro ‚Äì Mini √çndice (WIN)</title>

<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:#f3f4f6;
}
header{
  background:#111827;
  color:#fff;
  padding:10px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
}
#relogio{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  margin:12px 0;
}
#layout{
  display:flex;
  justify-content:center;
  gap:15px;
  padding:10px;
}

/* ===== TABELA CENTRAL (N√ÉO MEXER) ===== */
#macro{
  width:420px;
  background:#fff;
  border-radius:8px;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
  padding:12px;
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th{
  background:#1f2937;
  color:#fff;
  padding:8px;
}
td{
  padding:6px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
  font-weight:bold;
}
.alta{ background:#dcfce7; color:#065f46; }
.baixa{ background:#fee2e2; color:#7f1d1d; }
.neutra{ background:#fef9c3; color:#78350f; }

#direcao{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  padding:10px;
  margin-top:10px;
  border-radius:6px;
}

/* ===== PAINEL DIREITO ===== */
#painel-direito{
  width:360px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* BREAKING NEWS */
#breaking{
  background:#111827;
  color:#fff;
  border-radius:6px;
  box-shadow:0 2px 8px rgba(0,0,0,.25);
}
.breaking-header{
  background:#7f1d1d;
  padding:8px;
  font-weight:bold;
  text-align:center;
}
#breaking-list{
  max-height:220px;
  overflow-y:auto;
  font-size:13px;
}
.breaking-item{
  padding:8px;
  border-bottom:1px solid #374151;
}
.breaking-item a{
  color:#93c5fd;
  text-decoration:none;
}

/* NOT√çCIAS MERCADO */
#mercado{
  background:#ffffff;
  border-radius:6px;
  box-shadow:0 2px 8px rgba(0,0,0,.2);
}
.mercado-header{
  background:#1f2937;
  color:#fff;
  padding:8px;
  font-weight:bold;
  text-align:center;
}
#mercado-list{
  max-height:220px;
  overflow-y:auto;
  font-size:13px;
}
.mercado-item{
  padding:8px;
  border-bottom:1px solid #e5e7eb;
}
.mercado-item a{
  color:#1d4ed8;
  text-decoration:none;
}

/* ALERTA VISUAL */
.alerta-contrario{
  animation:pulse 1s infinite;
}
@keyframes pulse{
  0%{background:#fee2e2;}
  50%{background:#fecaca;}
  100%{background:#fee2e2;}
}
</style>
</head>

<body>

<header>
üìä Dire√ß√£o Macro do Mercado ‚Äì Mini √çndice (WIN)
</header>

<div id="relogio"></div>

<div id="layout">

  <!-- TABELA CENTRAL (INTACTA) -->
  <div id="macro">
    <table>
      <thead>
        <tr><th>Ativo</th><th>Leitura</th></tr>
      </thead>
      <tbody>
        <tr><td>S&P 500</td><td class="alta">ALTA</td></tr>
        <tr><td>VIX</td><td class="baixa">BAIXA</td></tr>
        <tr><td>DXY</td><td class="neutra">NEUTRO</td></tr>
        <tr><td>DI Futuro</td><td class="baixa">BAIXA</td></tr>
      </tbody>
    </table>

    <div id="direcao" class="alta" data-macro="ALTA">
      üü¢ MACRO ALTA<br>Priorizar COMPRAS no WIN
    </div>
  </div>

  <!-- PAINEL DIREITO -->
  <div id="painel-direito">

    <div id="breaking">
      <div class="breaking-header">üö® BREAKING NEWS</div>
      <div id="breaking-list">
        <div class="breaking-item">Aguardando not√≠cias...</div>
      </div>
    </div>

    <div id="mercado">
      <div class="mercado-header">üì∞ Not√≠cias de Mercado</div>
      <div id="mercado-list">
        <div class="mercado-item">Aguardando not√≠cias...</div>
      </div>
    </div>

  </div>
</div>

<audio id="somAlerta" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
// REL√ìGIO BRAS√çLIA
function atualizarRelogio(){
  const agora = new Date();
  const utc = agora.getTime() + agora.getTimezoneOffset()*60000;
  const br = new Date(utc - 3*3600000);
  document.getElementById("relogio").innerHTML =
    "‚è∞ Hor√°rio de Bras√≠lia: " + br.toLocaleTimeString("pt-BR");
}
setInterval(atualizarRelogio,1000);
atualizarRelogio();

// PALAVRAS NEGATIVAS (RISCO OFF)
const negativas = ["queda","crise","guerra","juros","alta de juros","inflation","recess√£o","risco"];

// BREAKING NEWS COM ALERTA CONTR√ÅRIO
const breakingList = document.getElementById("breaking-list");
const som = document.getElementById("somAlerta");

async function buscarBreaking(){
  const rss = "https://news.google.com/rss/search?q=fed+OR+juros+OR+guerra+OR+infla√ß√£o&hl=pt-BR&gl=BR&ceid=BR:pt";
  const url = "https://api.allorigins.win/raw?url=" + encodeURIComponent(rss);
  const res = await fetch(url);
  const text = await res.text();
  const xml = new DOMParser().parseFromString(text,"text/xml");
  const items = xml.querySelectorAll("item");

  breakingList.innerHTML="";

  items.forEach((item,i)=>{
    if(i>4) return;
    const titulo=item.querySelector("title").textContent;
    const link=item.querySelector("link").textContent;

    const div=document.createElement("div");
    div.className="breaking-item";
    div.innerHTML=`<strong>${titulo}</strong><br><a href="${link}" target="_blank">Ler</a>`;
    breakingList.appendChild(div);

    const macro = document.getElementById("direcao").dataset.macro;
    const texto = titulo.toLowerCase();

    if(macro !== "NEUTRO" && negativas.some(p=>texto.includes(p))){
      document.getElementById("breaking").classList.add("alerta-contrario");
      som.play().catch(()=>{});
      setTimeout(()=>{
        document.getElementById("breaking").classList.remove("alerta-contrario");
      },15000);
    }
  });
}
buscarBreaking();
setInterval(buscarBreaking,30000);

// NOT√çCIAS MERCADO
const mercadoList = document.getElementById("mercado-list");
async function buscarMercado(){
  const rss = "https://news.google.com/rss/search?q=mercado+financeiro+OR+b3+OR+economia+brasil&hl=pt-BR&gl=BR&ceid=BR:pt";
  const url = "https://api.allorigins.win/raw?url=" + encodeURIComponent(rss);
  const res = await fetch(url);
  const text = await res.text();
  const xml = new DOMParser().parseFromString(text,"text/xml");
  const items = xml.querySelectorAll("item");

  mercadoList.innerHTML="";
  items.forEach((item,i)=>{
    if(i>4) return;
    const t=item.querySelector("title").textContent;
    const l=item.querySelector("link").textContent;
    const div=document.createElement("div");
    div.className="mercado-item";
    div.innerHTML=`${t}<br><a href="${l}" target="_blank">Ler</a>`;
    mercadoList.appendChild(div);
  });
}
buscarMercado();
setInterval(buscarMercado,60000);
</script>

</body>
</html>
