<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>GPS de Mercado ‚Äì Painel Completo</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#f3f4f6;}
header{background:#111827;color:#fff;padding:10px;text-align:center;font-size:18px;font-weight:bold;}
#relogio{background:#1f2937;color:#fff;text-align:center;font-size:18px;font-weight:bold;padding:8px;}

#topo{display:flex;justify-content:space-between;gap:12px;padding:12px;}
.caixa{width:32%;background:#fff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);overflow:hidden;}
.caixa h3{margin:0;padding:8px;background:#1f2937;color:#fff;text-align:center;font-size:15px;}
.caixa.breaking h3{background:#b91c1c;}

.lista{max-height:220px;overflow-y:auto;font-size:14px;}
.item{padding:8px;border-bottom:1px solid #e5e7eb;}
.item a{text-decoration:none;color:#1d4ed8;}
.item.alerta{background:#fee2e2;border-left:4px solid #dc2626;font-weight:bold;}

#layout{display:flex;justify-content:center;padding:10px;}
#macro{width:420px;background:#fff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);padding:12px;text-align:center;}

#ativos-risco{width:100%;border-collapse:collapse;margin-bottom:12px;font-size:14px;}
#ativos-risco th{background:#1f2937;color:#fff;padding:8px;}
#ativos-risco td{padding:6px;border-bottom:1px solid #e5e7eb;text-align:center;font-weight:bold;}

.alta{background:#dcfce7;color:#065f46;}
.baixa{background:#fee2e2;color:#7f1d1d;}
.neutra{background:#fef9c3;color:#78350f;}

#direcao{font-size:20px;font-weight:bold;padding:12px;border-radius:6px;}

#grafico-container{
  width:90%;
  max-width:1000px;
  margin:20px auto;
  background:#fff;
  padding:15px;
  border-radius:8px;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
}
</style>
</head>

<body>

<header>üìä GPS de Mercado ‚Äì Mini √çndice</header>
<div id="relogio">‚è∞ --:--:--</div>

<div id="topo">
  <div class="caixa">
    <h3>üì∞ Not√≠cias de Mercado</h3>
    <div class="lista" id="noticias-mercado"><div class="item">Carregando...</div></div>
  </div>

  <div class="caixa">
    <h3>üìå Vis√£o Geral</h3>
    <div class="lista" style="text-align:center;padding:20px;font-weight:bold;">
      Painel Macro<br>Atualiza√ß√£o cont√≠nua
    </div>
  </div>

  <div class="caixa breaking">
    <h3>üö® Breaking News</h3>
    <div class="lista" id="breaking-news"><div class="item">Carregando...</div></div>
  </div>
</div>

<div id="layout">
  <div id="macro">
    <table id="ativos-risco">
      <thead>
        <tr><th>Ativo</th><th>Leitura</th></tr>
      </thead>
      <tbody>
        <tr><td>S&P 500</td><td id="sp500" class="neutra">NEUTRO</td></tr>
        <tr><td>VIX</td><td id="vix" class="neutra">NEUTRO</td></tr>
        <tr><td>DXY</td><td id="dxy" class="neutra">NEUTRO</td></tr>
        <tr><td>DI Futuro</td><td id="di" class="neutra">NEUTRO</td></tr>
      </tbody>
    </table>
    <div id="direcao" class="neutra">üü° NEUTRO</div>
  </div>
</div>

<div id="grafico-container">
  <canvas id="grafico"></canvas>
</div>

<script>
// ===== REL√ìGIO =====
setInterval(()=>{
  document.getElementById("relogio").innerText =
    "‚è∞ Hor√°rio de Bras√≠lia: " + new Date().toLocaleTimeString("pt-BR");
},1000);

// ===== GR√ÅFICO (TEMPO REAL 1 MIN + HIST√ìRICO DO DIA) =====
const ctx=document.getElementById("grafico").getContext("2d");
let risco=0, seguranca=0;
let diaAtual = new Date().toDateString();
const MAX_PONTOS = 420; // ~ preg√£o completo

const grafico=new Chart(ctx,{
  type:"line",
  data:{
    labels:[],
    datasets:[
      {
        label:"Ativos de Risco (%)",
        data:[],
        borderColor:"#16a34a",
        backgroundColor:"rgba(22,163,74,0.12)",
        tension:0.4,
        fill:true
      },
      {
        label:"Ativos de Seguran√ßa (%)",
        data:[],
        borderColor:"#dc2626",
        backgroundColor:"rgba(220,38,38,0.12)",
        tension:0.4,
        fill:true
      }
    ]
  },
  options:{
    responsive:true,
    interaction:{mode:"index",intersect:false},
    scales:{
      y:{title:{display:true,text:"Varia√ß√£o (%)"}},
      x:{title:{display:true,text:"Hor√°rio"}}
    }
  }
});

function atualizarGrafico(){
  const hoje = new Date().toDateString();

  // Reset autom√°tico no novo dia
  if(hoje !== diaAtual){
    grafico.data.labels = [];
    grafico.data.datasets[0].data = [];
    grafico.data.datasets[1].data = [];
    risco = 0;
    seguranca = 0;
    diaAtual = hoje;
  }

  // Simula√ß√£o macro correlacionada
  risco += (Math.random() - 0.45) * 0.2;
  seguranca += (Math.random() - 0.55) * 0.15;

  grafico.data.labels.push(
    new Date().toLocaleTimeString("pt-BR",{hour12:false})
  );
  grafico.data.datasets[0].data.push(Number(risco.toFixed(2)));
  grafico.data.datasets[1].data.push(Number(seguranca.toFixed(2)));

  // Limite de hist√≥rico
  if(grafico.data.labels.length > MAX_PONTOS){
    grafico.data.labels.shift();
    grafico.data.datasets[0].data.shift();
    grafico.data.datasets[1].data.shift();
  }

  grafico.update();
}

// Inicializa√ß√£o
atualizarGrafico();
setInterval(atualizarGrafico,60000);
</script>

</body>
</html>
