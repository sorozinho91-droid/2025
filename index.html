<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>DireÃ§Ã£o do Dia â€“ Risco x SeguranÃ§a</title>
<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
<style>
  body{margin:0;background:#0e0e0e;color:#eee;font-family:Arial}
  #chart{width:100vw;height:520px}
</style>
</head>
<body>

<h2 style="padding:12px">ğŸ“Š DireÃ§Ã£o do Mercado</h2>
<div id="chart"></div>

<script>
const chart = LightweightCharts.createChart(
  document.getElementById('chart'),
  { layout:{ background:{color:'#0e0e0e'}, textColor:'#ccc' } }
);

const riskSeries   = chart.addLineSeries({ color:'#00ff88', lineWidth:3 });
const safetySeries = chart.addLineSeries({ color:'#ff4444', lineWidth:3 });

const riskData = [];
const safetyData = [];
const MAX = 390;

const ws = new WebSocket('ws://localhost:8080');

ws.onmessage = e => {
  const d = JSON.parse(e.data);

  riskData.push({ time:d.time, value:d.risk });
  safetyData.push({ time:d.time, value:d.safety });

  if (riskData.length > MAX) {
    riskData.shift();
    safetyData.shift();
  }

  riskSeries.setData(riskData);
  safetySeries.setData(safetyData);
};
</script>

</body>
</html>
