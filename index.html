<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Terminal de Decis칚o Macro - V3</title>
    <!-- Carregamento robusto da biblioteca -->
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --text: #eaecef; --buy: #2ebd85; --sell: #f6465d; --neutral: #94a3b8; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .container { max-width: 1100px; margin: auto; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #2b3139; padding-bottom: 15px; }
        .signal-badge { padding: 10px 20px; border-radius: 5px; font-weight: bold; font-size: 1.4rem; border: 1px solid #444; }
        .main-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-top: 20px; }
        .card { background: var(--card); border-radius: 12px; padding: 20px; border: 1px solid #2b3139; }
        .power-value { font-size: 3.5rem; font-weight: bold; text-align: center; margin: 10px 0; }
        .chart-box { height: 280px; position: relative; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>游늵 MACRO TERMINAL</h1>
        <div id="signal" class="signal-badge" style="color: var(--neutral)">AGUARDANDO...</div>
    </div>

    <div class="main-grid">
        <!-- M칄TRICA DE DECIS츾O -->
        <div class="card">
            <h3 style="margin:0; color: var(--neutral)">FOR칂A DO 칈NDICE</h3>
            <div id="power" class="power-value">0%</div>
            <div style="height: 180px;">
                <canvas id="gaugeChart"></canvas>
            </div>
            <p style="text-align:center; font-size: 0.8rem; color: #666;">ALVO: >70 COMPRA | <30 VENDA</p>
        </div>

        <!-- GR츼FICO DE FLUXO -->
        <div class="card">
            <h3 style="margin:0; color: var(--neutral)">FLUXO DE TEND칅NCIA (TEMPO REAL)</h3>
            <div class="chart-box">
                <canvas id="historyChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
    // Garantir que o script s칩 rode ap칩s o Chart.js carregar
    window.onload = function() {
        const ctxGauge = document.getElementById('gaugeChart').getContext('2d');
        const ctxHistory = document.getElementById('historyChart').getContext('2d');

        // Gr치fico de Veloc칤metro (Gauge)
        const gaugeChart = new Chart(ctxGauge, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [50, 50], // Valores iniciais corrigidos
                    backgroundColor: ['#2ebd85', '#2b3139'],
                    borderWidth: 0,
                    circumference: 180,
                    rotation: 270
                }]
            },
            options: { cutout: '85%', plugins: { tooltip: {enabled: false} } }
        });

        // Gr치fico de Hist칩rico
        const historyChart = new Chart(ctxHistory, {
            type: 'line',
            data: {
                labels: Array(20).fill(''),
                datasets: [{
                    label: 'For칞a',
                    data: Array(20).fill(50), // Dados iniciais preenchidos
                    borderColor: '#2ebd85',
                    backgroundColor: 'rgba(46, 189, 133, 0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: { 
                    y: { min: 0, max: 100, grid: { color: '#2b3139' } },
                    x: { display: false }
                }
            }
        });

        function update() {
            const val = Math.floor(Math.random() * 101);
            const signal = document.getElementById('signal');
            const power = document.getElementById('power');

            // L칩gica de Decis칚o Visual
            if (val >= 70) {
                signal.innerText = "SINAL: COMPRA";
                signal.style.borderColor = 'var(--buy)';
                signal.style.color = 'var(--buy)';
                historyChart.data.datasets[0].borderColor = 'var(--buy)';
            } else if (val <= 30) {
                signal.innerText = "SINAL: VENDA";
                signal.style.borderColor = 'var(--sell)';
                signal.style.color = 'var(--sell)';
                historyChart.data.datasets[0].borderColor = 'var(--sell)';
            } else {
                signal.innerText = "SINAL: NEUTRO";
                signal.style.borderColor = '#444';
                signal.style.color = 'var(--neutral)';
                historyChart.data.datasets[0].borderColor = '#2ebd85';
            }

            power.innerText = val + "%";
            power.style.color = signal.style.color;

            // Atualiza칞칚o dos Gr치ficos
            gaugeChart.data.datasets[0].data = [val, 100 - val];
            gaugeChart.data.datasets[0].backgroundColor[0] = signal.style.color;
            gaugeChart.update('none');

            historyChart.data.datasets[0].data.push(val);
            historyChart.data.datasets[0].data.shift();
            historyChart.update('none');
        }

        setInterval(update, 2500);
        update(); // Primeira execu칞칚o imediata
    };
</script>
</body>
</html>
