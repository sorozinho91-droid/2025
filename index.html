<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Sentimento de Mercado - Risk On x Risk Off</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: #eee;
            padding: 20px;
        }
        canvas {
            background: #1c1c1c;
            border-radius: 8px;
        }
        h2 {
            text-align: center;
        }
    </style>
</head>
<body>

<h2>ðŸ“Š Sentimento de Mercado â€“ Intraday</h2>
<canvas id="marketChart"></canvas>

<script>
    const ctx = document.getElementById('marketChart').getContext('2d');

    // Gera timestamps intraday (1 ponto por minuto)
    function generateTimeLabels(minutes = 390) {
        const labels = [];
        let now = new Date();
        now.setHours(9, 30, 0, 0);

        for (let i = 0; i < minutes; i++) {
            labels.push(
                now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })
            );
            now.setMinutes(now.getMinutes() + 1);
        }
        return labels;
    }

    // SimulaÃ§Ã£o de preÃ§os normalizados
    function generateSeries(base = 100, volatility = 0.05, points = 390) {
        const data = [base];
        for (let i = 1; i < points; i++) {
            let change = (Math.random() - 0.5) * volatility;
            data.push(data[i - 1] * (1 + change));
        }
        return data;
    }

    const labels = generateTimeLabels();

    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                // Risk-On
                {
                    label: 'SP500 (Risk-On)',
                    data: generateSeries(100, 0.002),
                    borderColor: '#00ff88',
                    borderWidth: 2,
                    tension: 0.3
                },
                {
                    label: 'Nasdaq (Risk-On)',
                    data: generateSeries(100, 0.003),
                    borderColor: '#00ccff',
                    borderWidth: 2,
                    tension: 0.3
                },

                // Risk-Off
                {
                    label: 'Ouro (Risk-Off)',
                    data: generateSeries(100, 0.001),
                    borderColor: '#ffd700',
                    borderDash: [5, 5],
                    borderWidth: 2,
                    tension: 0.3
                },
                {
                    label: 'DÃ³lar (Risk-Off)',
                    data: generateSeries(100, 0.001),
                    borderColor: '#ff5555',
                    borderDash: [5, 5],
                    borderWidth: 2,
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: '#eee'
                    }
                }
            },
            scales: {
                x: {
                    ticks: { color: '#aaa' },
                    grid: { color: '#333' }
                },
                y: {
                    ticks: { color: '#aaa' },
                    grid: { color: '#333' },
                    title: {
                        display: true,
                        text: 'Performance Normalizada (Base 100)',
                        color: '#aaa'
                    }
                }
            }
        }
    });

    // AtualizaÃ§Ã£o a cada 60s (simulada)
    setInterval(() => {
        chart.data.datasets.forEach(ds => {
            const last = ds.data[ds.data.length - 1];
            const change = (Math.random() - 0.5) * 0.002;
            ds.data.push(last * (1 + change));
            ds.data.shift();
        });

        chart.update();
    }, 60000);
</script>

</body>
</html>
