<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sentimento de Mercado â€“ Risco x SeguranÃ§a</title>

<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<style>
    body {
        margin: 0;
        background: #0e0e0e;
        color: #e0e0e0;
        font-family: Arial, sans-serif;
    }
    h2 {
        padding: 12px;
    }
    #chart {
        width: 100vw;
        height: 520px;
    }
</style>
</head>

<body>

<h2>ðŸ“Š Sentimento de Mercado â€“ DireÃ§Ã£o do Dia</h2>
<div id="chart"></div>

<script>
/* â”€â”€â”€â”€â”€ GrÃ¡fico â”€â”€â”€â”€â”€ */
const container = document.getElementById('chart');

const chart = LightweightCharts.createChart(container, {
    width: container.clientWidth,
    height: container.clientHeight,
    layout: {
        background: { color: '#0e0e0e' },
        textColor: '#cfcfcf',
    },
    grid: {
        vertLines: { color: '#222' },
        horzLines: { color: '#222' },
    },
    timeScale: {
        timeVisible: true,
        secondsVisible: false,
    }
});

/* â”€â”€â”€â”€â”€ SÃ©ries â”€â”€â”€â”€â”€ */
const riskSeries = chart.addLineSeries({
    color: '#00ff88',
    lineWidth: 3,
    title: 'RISCO'
});

const safetySeries = chart.addLineSeries({
    color: '#ff4444',
    lineWidth: 3,
    title: 'SEGURANÃ‡A'
});

/* â”€â”€â”€â”€â”€ SimulaÃ§Ã£o baseada na sua tabela â”€â”€â”€â”€â”€ */
let t = Math.floor(Date.now() / 1000);

// base 100
let risk = 100;
let safety = 100;

function update() {

    // risco: bolsas + commodities (mais volÃ¡til)
    let riskMove =
        (Math.random() - 0.5) * 0.003 +   // aÃ§Ãµes
        (Math.random() - 0.5) * 0.002 +   // commodities
        (Math.random() - 0.5) * 0.002;    // minÃ©rio (peso)

    // seguranÃ§a: ouro + dÃ³lar + vix (menos volÃ¡til)
    let safetyMove =
        (Math.random() - 0.5) * 0.0015 +
        (Math.random() - 0.5) * 0.001;

    risk *= (1 + riskMove);
    safety *= (1 + safetyMove);

    riskSeries.update({ time: t, value: risk });
    safetySeries.update({ time: t, value: safety });

    t += 60;
}

/* â”€â”€â”€â”€â”€ HistÃ³rico de 1 dia (~390 minutos) â”€â”€â”€â”€â”€ */
for (let i = 0; i < 390; i++) {
    update();
}

/* â”€â”€â”€â”€â”€ AtualizaÃ§Ã£o a cada 60s â”€â”€â”€â”€â”€ */
setInterval(update, 60000);

/* â”€â”€â”€â”€â”€ Resize â”€â”€â”€â”€â”€ */
window.addEventListener('resize', () => {
    chart.resize(container.clientWidth, container.clientHeight);
});
</script>

</body>
</html>
