<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard de Not√≠cias Financeiras em Tempo Real</title>
<style>
body {
  background:#0e0e0e;
  color:#e0e0e0;
  font-family:Arial, Helvetica, sans-serif;
  margin:20px;
}
h2 { color:#fff; }
.section {
  background:#111;
  padding:15px;
  border-radius:8px;
  margin-bottom:20px;
}
.news-item {
  border-bottom:1px solid #222;
  padding:8px 0;
  transition: all 0.3s;
}
.news-item:last-child { border-bottom:none; }
.news-item a { color:#03a9f4; text-decoration:none; }
.news-item a:hover { text-decoration:underline; }
.news-title { font-weight:bold; font-size:16px; }
.news-desc { font-size:14px; color:#ccc; }

/* Destaque para not√≠cias cr√≠ticas */
.urgente { background: #b71c1c; color:#fff; padding:5px 8px; border-radius:4px; }
</style>
</head>
<body>

<h2>üì∞ Not√≠cias de Mercado Financeiro</h2>
<div class="section" id="finance-news">Carregando...</div>

<h2>üö® Breaking News</h2>
<div class="section" id="breaking-news">Carregando...</div>

<script>
// Palavras-chave urgentes
const palavrasUrgentes = [
    'crise','queda','alta','volatilidade','fal√™ncia',
    'guerra','poli','desastre naturais'
];

// Feeds confi√°veis
const feedsFinance = [
    'https://valor.globo.com/rss/mercados/',
    'https://www.infomoney.com.br/feed/',
    'https://www.reuters.com/rssFeed/marketsNews'
];

const feedsBreaking = [
    'https://g1.globo.com/rss/g1/ultimas-noticias.rss',
    'https://www.reuters.com/rssFeed/topNews'
];

// Busca RSS usando AllOrigins para contornar CORS
async function buscarRSS(url, max=5){
    try{
        const res = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(url)}`);
        const data = await res.json();
        const parser = new DOMParser();
        const xml = parser.parseFromString(data.contents, "text/xml");
        const items = Array.from(xml.querySelectorAll("item")).slice(0, max);
        return items.map(item => ({
            title: item.querySelector("title")?.textContent || "",
            link: item.querySelector("link")?.textContent || "",
            desc: item.querySelector("description")?.textContent || ""
        }));
    }catch(err){
        console.error("Erro RSS:", err);
        return [];
    }
}

// Verifica se not√≠cia √© urgente
function isUrgente(article){
    const texto = (article.title + " " + article.desc).toLowerCase();
    return palavrasUrgentes.some(p => texto.includes(p.toLowerCase()));
}

// Atualiza se√ß√£o de not√≠cias
async function atualizarSecao(feeds, containerId){
    const container = document.getElementById(containerId);
    container.innerHTML = '';

    for(const feed of feeds){
        const noticias = await buscarRSS(feed, 5);
        noticias.forEach(article=>{
            const item = document.createElement('div');
            item.className = 'news-item';
            if(isUrgente(article)) item.classList.add('urgente');

            item.innerHTML = `
                <div class="news-title"><a href="${article.link}" target="_blank">${article.title}</a></div>
                <div class="news-desc">${article.desc.replace(/<\/?[^>]+(>|$)/g, "")}</div>
            `;
            container.appendChild(item);
        });
    }

    if(container.innerHTML === '') container.innerHTML = 'Nenhuma not√≠cia no momento.';
}

// Atualiza automaticamente
async function atualizarNoticias(){
    await atualizarSecao(feedsFinance, 'finance-news');
    await atualizarSecao(feedsBreaking, 'breaking-news');
}

// Inicializa
atualizarNoticias();
setInterval(atualizarNoticias, 60000);
</script>

</body>
</html>
