<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Risco x Segurança - Atualização 60s</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        #grafico {
            width: 90%;
            height: 500px;
            margin: auto;
        }
        h2 {
            margin-top: 15px;
        }
    </style>
</head>
<body>

<h2>Ativos de Risco x Segurança (Atualização a cada 60s)</h2>
<div id="grafico"></div>

<script>
    const datas = [];
    const risco = [];
    const seguro = [];

    let valorRisco = 100;
    let valorSeguro = 100;

    const intervalo = 60000; // 60 segundos
    const limitePontos = 60; // mantém últimos 60 minutos

    function atualizarValor(valor, volatilidade) {
        return Math.max(0, valor + (Math.random() - 0.5) * volatilidade);
    }

    // Inicialização
    const agora = new Date();
    datas.push(agora);
    risco.push(valorRisco);
    seguro.push(valorSeguro);

    const traceRisco = {
        x: datas,
        y: risco,
        type: 'scatter',
        mode: 'lines+markers',
        name: 'Risco',
        line: { color: 'red', width: 3 }
    };

    const traceSeguro = {
        x: datas,
        y: seguro,
        type: 'scatter',
        mode: 'lines+markers',
        name: 'Segurança',
        line: { color: 'green', width: 3 }
    };

    const layout = {
        title: 'Risco x Segurança',
        xaxis: { title: 'Horário', type: 'date' },
        yaxis: { title: 'Valor' },
        margin: { t: 50, r: 30, l: 50, b: 50 }
    };

    Plotly.newPlot('grafico', [traceRisco, traceSeguro], layout);

    // Atualização a cada 60 segundos
    setInterval(() => {
        const agora = new Date();

        valorRisco = atualizarValor(valorRisco, 4);   // mais volátil
        valorSeguro = atualizarValor(valorSeguro, 1); // mais estável

        datas.push(agora);
        risco.push(valorRisco);
        seguro.push(valorSeguro);

        // Limita o histórico
        if (datas.length > limitePontos) {
            datas.shift();
            risco.shift();
            seguro.shift();
        }

        Plotly.update('grafico', {
            x: [datas, datas],
            y: [risco, seguro]
        });

    }, intervalo);

    // Responsivo
    window.addEventListener('resize', () => {
        Plotly.Plots.resize('grafico');
    });
</script>

</body>
</html>
