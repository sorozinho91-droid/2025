';
        const API_IPCA_HIST = 'api.bcb.gov.br';
        const API_SELIC_HIST = 'api.bcb.gov.br';
        
        // !!! IMPORTANTE: Insira sua chave de API de commodities aqui. Ex: da Financial Modeling Prep
        const COMMODITIES_API_KEY = 'SUA_CHAVE_DE_API_AQUI'; 
        // Exemplo de URL da FMP: const API_BRENT = `financialmodelingprep.com{COMMODITIES_API_KEY}`;

        async function fetchData() {
            try {
                // Fetch de dados financeiros e governamentais
                const [resIbov, resUsd, resIpca, resSelic] = await Promise.all([
                    fetch(API_IBOV), fetch(API_USD), fetch(API_IPCA_HIST), fetch(API_SELIC_HIST)
                ]);
                const dataIbov = await resIbov.json();
                const dataUsd = await resUsd.json();
                const dataIpca = await resIpca.json();
                const dataSelic = await resSelic.json();

                // Processamento de dados e atualização do HTML... (código das respostas anteriores)

                const ibov = dataIbov.results;
                const usd = dataUsd.currencies.find(item => item.currency === 'USD');
                const ultimoIpca = parseFloat(dataIpca[dataIpca.length - 1].valor);
                const ultimaSelic = parseFloat(dataSelic[dataSelic.length - 1].valor);

                updateIndicator('ibov', ibov.regularMarketPrice.toFixed(0), ibov.changePercent.toFixed(2), ibov.changePercent > 0);
                updateIndicator('usd', usd.buy.toFixed(4), usd.variation.toFixed(2), usd.variation < 0);
                renderChart('ipcaChart', 'IPCA (12 meses)', dataIpca);
                renderChart('selicChart', 'Selic (Meta a.a.)', dataSelic);
                generateDiagnostic(ibov.changePercent, usd.variation, ultimoIpca, ultimaSelic);

                // --- Implementação das Commodities ---
                if (COMMODITIES_API_KEY !== 'SUA_CHAVE_DE_API_AQUI') {
                     // Exemplo de fetch (use a URL específica do seu provedor de API)
                     // const resBrent = await fetch(`SUA_URL_API_BRENT_AQUI`);
                     // const dataBrent = await resBrent.json();
                     // const brent = dataBrent[0]; // Ajuste o índice conforme a estrutura da sua API
                     // updateIndicator('brent', brent.price.toFixed(2), brent.changesPercentage.toFixed(2), brent.changesPercentage > 0);
                     // Repita para Minério de Ferro
                } else {
                    document.getElementById('brent-value').textContent = 'Chave Necessária';
                    document.getElementById('iron-value').textContent = 'Chave Necessária';
                }


            } catch (error) {
                console.error('Erro geral:', error);
            }
        }

        function updateIndicator(id, value, change, isPositive) { /* ... (mesma função de antes) ... */
            document.getElementById(id + '-value').textContent = (id === 'usd' ? 'R$ ' : '') + value;
            document.getElementById(id + '-change').textContent = change + '%';
            document.getElementById(id + '-change').className = isPositive ? 'change positive' : 'change negative';
        }
        function renderChart(canvasId, labelText, historicalData) { /* ... (mesma função de antes) ... */
             const ctx = document.getElementById(canvasId).getContext('2d');
            const dates = historicalData.map(item => item.data);
            const values = historicalData.map(item => parseFloat(item.valor));
            new Chart(ctx, {type: 'line', data: {labels: dates, datasets: [{label: labelText, data: values, borderColor: canvasId === 'ipcaChart' ? '#e74c3c' : '#3498db', borderWidth: 2, fill: false}]}, options: {responsive: true, scales: { y: { beginAtZero: false } }} });
        }
        function generateDiagnostic(ibovChange, usdChange, ipcaValue, selicValue) { /* ... (mesma função de antes) ... */
            const diagnosticElement = document.getElementById('diagnostico-consolidado');
            let message = '';
            let className = '';
            const isIbovPositive = ibovChange > 0;
            const isUsdPositive = usdChange < 0; 
            const isIpcaOk = ipcaValue <= 5.0; 
            const isSelicOk = selicValue <= 13.0;

            if (isIbovPositive && isUsdPositive && isIpcaOk && isSelicOk) {
                message = 'Momento **Altamente Positivo**: Todos os indicadores principais apontam para um cenário favorável de crescimento e controle fiscal.';
                className = 'positive';
            } else if (!isIbovPositive && !isUsdPositive && !isIpcaOk && !isSelicOk) {
                message = 'Momento **Altamente Negativo**: Todos os indicadores principais apontam para um cenário de estresse, com inflação/juros altos, dólar subindo e bolsa caindo.';
                className = 'negative';
            } else {
                message = 'Momento **Misto/Neutro**: Indicadores mostram movimentos conflitantes. O mercado aguarda por definições políticas ou externas.';
                className = 'neutral';
            }
            diagnosticElement.innerHTML = message;
            diagnosticElement.className = className;
        }

        fetchData();
        setInterval(fetchData, 60000); 

        /* Isenção de Responsabilidade Financeira: Este painel utiliza dados públicos e serve apenas para fins ilustrativos e educacionais. Ele não constitui aconselhamento financeiro ou recomendação de investimento. Consulte um profissional certificado antes de tomar decisões financeiras. */
    </script>
</body>
</html>
