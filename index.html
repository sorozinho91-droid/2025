<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>GPS de Mercado ‚Äì Painel Completo</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#f3f4f6;}
header{
  background:#111827;
  color:#fff;
  padding:10px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
}
#relogio{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  padding:8px;
  background:#1f2937;
  color:#fff;
}

#topo{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:12px;
}

.caixa{
  width:32%;
  background:#fff;
  border-radius:8px;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
  overflow:hidden;
}

.caixa h3{
  background:#1f2937;
  color:#fff;
  margin:0;
  padding:8px;
  font-size:15px;
  text-align:center;
}

.caixa.breaking h3{
  background:#b91c1c;
}

.lista{
  max-height:220px;
  overflow-y:auto;
  font-size:14px;
}

.item{
  padding:8px;
  border-bottom:1px solid #e5e7eb;
}
.item a{
  text-decoration:none;
  color:#1d4ed8;
}
.item.alerta{
  background:#fee2e2;
  border-left:4px solid #dc2626;
  font-weight:bold;
}

#layout{
  display:flex;
  justify-content:center;
  gap:15px;
  padding:10px;
}

#macro{
  width:420px;
  background:#fff;
  border-radius:8px;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
  padding:12px;
  text-align:center;
}

#ativos-risco{
  width:100%;
  border-collapse:collapse;
  margin-bottom:12px;
  font-size:14px;
}
#ativos-risco th{
  background:#1f2937;
  color:#fff;
  padding:8px;
}
#ativos-risco td{
  padding:6px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
  font-weight:bold;
}

.alta{background:#dcfce7;color:#065f46;}
.baixa{background:#fee2e2;color:#7f1d1d;}
.neutra{background:#fef9c3;color:#78350f;}

#direcao{
  font-size:20px;
  font-weight:bold;
  padding:12px;
  border-radius:6px;
}

#grafico-container{
  width:90%;
  max-width:1000px;
  margin:20px auto;
  background:#fff;
  padding:15px;
  border-radius:8px;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
}
</style>
</head>

<body>

<header>üìä GPS de Mercado ‚Äì Mini √çndice</header>
<div id="relogio">‚è∞ --:--:--</div>

<!-- TOPO NOT√çCIAS -->
<div id="topo">
  <div class="caixa">
    <h3>üì∞ Not√≠cias de Mercado</h3>
    <div class="lista" id="noticias-mercado">
      <div class="item">Carregando...</div>
    </div>
  </div>

  <div class="caixa">
    <h3>üìå Vis√£o Macro</h3>
    <div class="lista" style="text-align:center;padding:20px;font-weight:bold;">
      Acompanhamento em tempo real<br>dos ativos globais
    </div>
  </div>

  <div class="caixa breaking">
    <h3>üö® Breaking News</h3>
    <div class="lista" id="breaking-news">
      <div class="item">Carregando...</div>
    </div>
  </div>
</div>

<!-- TABELAS -->
<div id="layout">
  <div id="macro">
    <table id="ativos-risco">
      <thead>
        <tr><th>Ativo</th><th>Leitura</th></tr>
      </thead>
      <tbody>
        <tr><td>S&P 500</td><td id="sp500" class="neutra">NEUTRO</td></tr>
        <tr><td>VIX</td><td id="vix" class="neutra">NEUTRO</td></tr>
        <tr><td>DXY</td><td id="dxy" class="neutra">NEUTRO</td></tr>
        <tr><td>DI Futuro</td><td id="di" class="neutra">NEUTRO</td></tr>
      </tbody>
    </table>

    <div id="direcao" class="neutra">üü° NEUTRO</div>
  </div>
</div>

<!-- GR√ÅFICO -->
<div id="grafico-container">
  <canvas id="grafico"></canvas>
</div>

<script>
// ===== REL√ìGIO =====
function atualizarRelogio(){
  document.getElementById("relogio").innerHTML =
    "‚è∞ Hor√°rio de Bras√≠lia: " + new Date().toLocaleTimeString("pt-BR");
}
setInterval(atualizarRelogio,1000);
atualizarRelogio();

// ===== NOT√çCIAS =====
async function carregarNoticias(destino, termo, alerta=false){
  const rss=`https://news.google.com/rss/search?q=${encodeURIComponent(termo)}&hl=pt-BR&gl=BR&ceid=BR:pt`;
  const url=`https://api.allorigins.win/raw?url=${encodeURIComponent(rss)}`;
  const res=await fetch(url);
  const txt=await res.text();
  const xml=new DOMParser().parseFromString(txt,"text/xml");
  const items=xml.querySelectorAll("item");
  destino.innerHTML="";
  items.forEach((i,idx)=>{
    if(idx>4) return;
    const t=i.querySelector("title").textContent;
    const l=i.querySelector("link").textContent;
    const div=document.createElement("div");
    div.className="item"+(alerta?" alerta":"");
    div.innerHTML=`${t}<br><a href="${l}" target="_blank">Ler</a>`;
    destino.appendChild(div);
  });
}

carregarNoticias(document.getElementById("noticias-mercado"),"mercado financeiro brasil");
carregarNoticias(document.getElementById("breaking-news"),"ibovespa OR juros OR infla√ß√£o OR crise",true);
setInterval(()=>carregarNoticias(document.getElementById("breaking-news"),"ibovespa OR juros OR infla√ß√£o OR crise",true),30000);

// ===== GR√ÅFICO =====
const ctx=document.getElementById("grafico").getContext("2d");
let risco=0,seguranca=0;

const grafico=new Chart(ctx,{
  type:"line",
  data:{
    labels:[],
    datasets:[
      {
        label:"Ativos de Risco (%)",
        data:[],
        borderColor:"#16a34a",
        backgroundColor:"rgba(22,163,74,0.12)",
        tension:0.4,
        fill:true
      },
      {
        label:"Ativos de Seguran√ßa (%)",
        data:[],
        borderColor:"#dc2626",
        backgroundColor:"rgba(220,38,38,0.12)",
        tension:0.4,
        fill:true
      }
    ]
  },
  options:{
    responsive:true,
    interaction:{mode:"index",intersect:false},
    scales:{
      y:{title:{display:true,text:"Varia√ß√£o (%)"}},
      x:{title:{display:true,text:"Hor√°rio"}}
    }
  }
});

function atualizarGrafico(){
  risco += (Math.random()-0.5)*0.15;
  seguranca += (Math.random()-0.5)*0.1;
  grafico.data.labels.push(new Date().toLocaleTimeString("pt-BR",{hour12:false}));
  grafico.data.datasets[0].data.push(risco.toFixed(2));
  grafico.data.datasets[1].data.push(seguranca.toFixed(2));
  grafico.update();
}
atualizarGrafico();
setInterval(atualizarGrafico,60000);
</script>

</body>
</html>
