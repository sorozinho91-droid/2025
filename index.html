<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sentimento de Mercado â€“ Risk On x Risk Off</title>

<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<style>
    body {
        background: #0f0f0f;
        color: #eee;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
    }
    #chart {
        width: 100%;
        height: 500px;
    }
</style>
</head>

<body>

<h2>ðŸ“Š Sentimento de Mercado (HTML + TradingView)</h2>
<div id="chart"></div>

<script>
/* â”€â”€â”€â”€â”€ CriaÃ§Ã£o do grÃ¡fico â”€â”€â”€â”€â”€ */
const chart = LightweightCharts.createChart(document.getElementById('chart'), {
    layout: {
        background: { color: '#0f0f0f' },
        textColor: '#ccc',
    },
    grid: {
        vertLines: { color: '#222' },
        horzLines: { color: '#222' },
    },
    timeScale: {
        timeVisible: true,
        secondsVisible: false,
    },
    rightPriceScale: {
        borderColor: '#333',
    },
});

/* â”€â”€â”€â”€â”€ SÃ©ries â”€â”€â”€â”€â”€ */
const riskOnSeries = chart.addLineSeries({
    color: '#00ff88',
    lineWidth: 2,
    title: 'Risk-On'
});

const riskOffSeries = chart.addLineSeries({
    color: '#ff5555',
    lineWidth: 2,
    lineStyle: LightweightCharts.LineStyle.Dashed,
    title: 'Risk-Off'
});

const sentimentSeries = chart.addLineSeries({
    color: '#3399ff',
    lineWidth: 3,
    title: 'Sentimento'
});

/* â”€â”€â”€â”€â”€ SimulaÃ§Ã£o de dados (substitua por API/WebSocket) â”€â”€â”€â”€â”€ */
let t = Math.floor(Date.now() / 1000);
let riskOn = 100;
let riskOff = 100;

function updateData() {
    riskOn *= 1 + (Math.random() - 0.5) * 0.002;
    riskOff *= 1 + (Math.random() - 0.5) * 0.001;

    const sentiment = riskOn - riskOff;

    riskOnSeries.update({ time: t, value: riskOn });
    riskOffSeries.update({ time: t, value: riskOff });
    sentimentSeries.update({ time: t, value: sentiment });

    t += 60;
}

/* â”€â”€â”€â”€â”€ HistÃ³rico inicial (1 dia ~ 390 minutos) â”€â”€â”€â”€â”€ */
for (let i = 0; i < 390; i++) {
    updateData();
}

/* â”€â”€â”€â”€â”€ AtualizaÃ§Ã£o a cada 60s â”€â”€â”€â”€â”€ */
setInterval(updateData, 60000);
</script>

</body>
</html>
