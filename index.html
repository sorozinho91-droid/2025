<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Terminal Macro - Decis√£o Imediata</title>
    <!-- Script com fallback de seguran√ßa -->
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --buy: #00ff88; --sell: #ff3355; --text: #f0f0f0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 15px; }
        .container { max-width: 1100px; margin: auto; }
        
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #2b3139; padding: 10px 0; }
        #status-light { width: 12px; height: 12px; background: #555; border-radius: 50%; display: inline-block; margin-right: 8px; }
        
        .main-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 15px; margin-top: 15px; }
        .card { background: var(--card); border-radius: 12px; padding: 20px; border: 1px solid #2b3139; text-align: center; }
        
        .signal-box { font-size: 2.8rem; font-weight: 900; margin: 15px 0; letter-spacing: -1px; }
        .power-meter { font-size: 1.2rem; color: #848e9c; }
        .chart-container { height: 280px; position: relative; width: 100%; }
        
        .warning { color: #f0b90b; font-size: 0.8rem; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2 style="margin:0">üìä MACRO CORE</h2>
        <div><span id="status-light"></span> <small id="status-text">Conectando...</small></div>
    </div>

    <div class="main-grid">
        <!-- PAINEL DE SINAL -->
        <div class="card">
            <div style="color: #848e9c; font-size: 0.8rem; text-transform: uppercase;">Sentimento Atual</div>
            <div id="signal" class="signal-box">---</div>
            <div class="power-meter">For√ßa: <span id="power-val">0</span>%</div>
            <div style="height: 120px; margin-top: 20px;">
                <canvas id="gaugeCanvas"></canvas>
            </div>
        </div>

        <!-- FLUXO DE TEND√äNCIA -->
        <div class="card">
            <div style="text-align: left; color: #848e9c; font-size: 0.8rem; margin-bottom: 10px;">HIST√ìRICO DE VOLATILIDADE</div>
            <div class="chart-container">
                <canvas id="historyCanvas"></canvas>
            </div>
            <div class="warning">‚ö†Ô∏è Dados simulados para an√°lise de tend√™ncia.</div>
        </div>
    </div>
</div>

<script>
    // Inicializa√ß√£o Protegida
    window.onload = function() {
        const light = document.getElementById('status-light');
        const status = document.getElementById('status-text');

        if (typeof Chart === 'undefined') {
            status.innerText = "Erro de Conex√£o (Chart.js)";
            light.style.background = "#ff3355";
            return;
        }

        light.style.background = "#00ff88";
        status.innerText = "LIVE - Dados Sincronizados";

        // Gr√°fico 1: Veloc√≠metro (Gauge)
        const gaugeChart = new Chart(document.getElementById('gaugeCanvas'), {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [50, 50],
                    backgroundColor: ['#444', '#2b3139'],
                    borderWidth: 0,
                    circumference: 180,
                    rotation: 270
                }]
            },
            options: { cutout: '85%', plugins: { tooltip: {enabled: false} } }
        });

        // Gr√°fico 2: Linha (Hist√≥rico)
        const historyChart = new Chart(document.getElementById('historyCanvas'), {
            type: 'line',
            data: {
                labels: Array(20).fill(''),
                datasets: [{
                    label: 'For√ßa',
                    data: Array(20).fill(50),
                    borderColor: '#00ff88',
                    backgroundColor: 'rgba(0, 255, 136, 0.05)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: { 
                    y: { min: 0, max: 100, grid: { color: '#2b3139' }, ticks: { color: '#555' } },
                    x: { display: false }
                }
            }
        });

        function tick() {
            // L√≥gica de Gera√ß√£o de Dados Est√°vel
            const val = Math.floor(Math.random() * 101);
            const signal = document.getElementById('signal');
            const power = document.getElementById('power-val');

            // Crit√©rios de Decis√£o
            if (val >= 70) {
                signal.innerText = "COMPRA";
                signal.style.color = "var(--buy)";
                historyChart.data.datasets[0].borderColor = "var(--buy)";
            } else if (val <= 30) {
                signal.innerText = "VENDA";
                signal.style.color = "var(--sell)";
                historyChart.data.datasets[0].borderColor = "var(--sell)";
            } else {
                signal.innerText = "NEUTRO";
                signal.style.color = "#848e9c";
                historyChart.data.datasets[0].borderColor = "#848e9c";
            }

            power.innerText = val;
            
            // Atualizar Gauge
            gaugeChart.data.datasets[0].data = [val, 100 - val];
            gaugeChart.data.datasets[0].backgroundColor[0] = signal.style.color;
            gaugeChart.update('none');

            // Atualizar Hist√≥rico
            historyChart.data.datasets[0].data.push(val);
            historyChart.data.datasets[0].data.shift();
            historyChart.update('none');
        }

        // Loop de 3 segundos
        setInterval(tick, 3000);
        tick(); // In√≠cio imediato
    };
</script>
</body>
</html>
