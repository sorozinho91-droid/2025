//@version=5
indicator("ðŸ“ˆ Risk-On x Risk-Off (Linhas)", overlay=false)

// ===== INPUT =====
len = input.int(50, "PerÃ­odo de NormalizaÃ§Ã£o", minval=10)

// ===== FUNÃ‡ÃƒO NORMALIZAÃ‡ÃƒO =====
norm(x) =>
    x / ta.sma(x, len)

// ===== RISK-ON =====
spx  = request.security("SP:SPX", timeframe.period, close)
ndx  = request.security("NASDAQ:NDX", timeframe.period, close)
ibov = request.security("BMFBOVESPA:IBOV", timeframe.period, close)
wti  = request.security("NYMEX:CL1!", timeframe.period, close)

risk_on = (
     norm(spx)
   + norm(ndx)
   + norm(ibov)
   + norm(wti)
) / 4

// ===== RISK-OFF =====
gold = request.security("COMEX:GC1!", timeframe.period, close)
dxy  = request.security("TVC:DXY", timeframe.period, close)
us10 = request.security("TVC:US10Y", timeframe.period, close)

risk_off = (
     norm(gold)
   + norm(dxy)
   + norm(us10)
) / 3

// ===== PLOTS =====
plot(risk_on,  title="Risk-On",  color=color.red,  linewidth=2)
plot(risk_off, title="Risk-Off", color=color.lime, linewidth=2)

// ===== REFERÃŠNCIA =====
hline(1, "Base Normalizada", color=color.gray, linestyle=hline.style_dotted)
