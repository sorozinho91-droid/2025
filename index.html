<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Mini Índice</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #333; color: white; }
  .termometro { height: 40px; width: 100%; text-align: center; color: white; font-weight: bold; }
  .venda-forte { background-color: #cc0000; }
  .venda { background-color: #ff6600; }
  .neutro { background-color: #ffff00; color: black; }
  .compra { background-color: #00cc00; }
  .compra-forte { background-color: #009900; }
  input { width: 60px; text-align: center; }
</style>
</head>
<body>

<h2>GERIS PRE-MARKET: Correlação de Índice Futuro</h2>
<table id="painel">
  <thead>
    <tr>
      <th>Categoria</th>
      <th>Indicador</th>
      <th>Peso</th>
      <th>Correlação</th>
      <th>Variação %</th>
      <th>Impacto</th>
    </tr>
  </thead>
  <tbody>
    <!-- Linhas serão inseridas via JS -->
  </tbody>
</table>

<div>
  <strong>Soma dos Impactos: </strong><span id="somaImpactos">0</span><br>
  <strong>Classificação do Mercado: </strong><span id="classificacao">NEUTRO</span>
</div>
<div class="termometro" id="termometro">NEUTRO</div>

<script>
const indicadores = [
  {categoria: 'Internos', indicador: 'Taxa Selic', peso: 0.12, correlacao: -1},
  {categoria: 'Internos', indicador: 'Juros Futuros DI1', peso: 0.12, correlacao: -1},
  {categoria: 'Internos', indicador: 'Fluxo Estrangeiro B3', peso: 0.15, correlacao: 1},
  {categoria: 'Internos', indicador: 'Ibovespa Spot', peso: 0.18, correlacao: 1},
  {categoria: 'Acoes Especificas', indicador: 'PETR4', peso: 0.08, correlacao: 1},
  {categoria: 'Acoes Especificas', indicador: 'VALE3', peso: 0.10, correlacao: 1},
  {categoria: 'Acoes Especificas', indicador: 'ITUB4', peso: 0.07, correlacao: 1},
  {categoria: 'Acoes Especificas', indicador: 'BBDC4', peso: 0.06, correlacao: 1},
  {categoria: 'Externos', indicador: 'S&P 500', peso: 0.14, correlacao: 1},
  {categoria: 'Externos', indicador: 'Nasdaq', peso: 0.10, correlacao: 1},
  {categoria: 'Externos', indicador: 'VIX', peso: 0.12, correlacao: -1},
  {categoria: 'Externos', indicador: 'Petroleo WTI', peso: 0.08, correlacao: 1},
  {categoria: 'Externos', indicador: 'Minerio de Ferro', peso: 0.09, correlacao: 1},
  {categoria: 'Externos', indicador: 'Ouro', peso: 0.06, correlacao: -1},
  {categoria: 'Externos', indicador: 'DXY - Dolar', peso: 0.11, correlacao: -1},
  {categoria: 'Emergentes', indicador: 'EWZ', peso: 0.13, correlacao: 1},
  {categoria: 'Emergentes', indicador: 'MSCI Emergentes', peso: 0.11, correlacao: 1}
];

const tbody = document.querySelector('#painel tbody');
indicadores.forEach((item, idx) => {
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${item.categoria}</td>
    <td>${item.indicador}</td>
    <td>${item.peso}</td>
    <td>${item.correlacao}</td>
    <td><input type='number' step='0.01' value='0' id='var_${idx}' onchange='calcularImpactos()'></td>
    <td id='impact_${idx}'>0</td>
  `;
  tbody.appendChild(tr);
});

function calcularImpactos() {
  let soma = 0;
  indicadores.forEach((item, idx) => {
    const variacao = parseFloat(document.getElementById(`var_${idx}`).value) || 0;
    const impacto = item.peso * item.correlacao * variacao;
    document.getElementById(`impact_${idx}`).innerText = impacto.toFixed(3);
    soma += impacto;
  });
  document.getElementById('somaImpactos').innerText = soma.toFixed(3);
  atualizarTermometro(soma);
}

function atualizarTermometro(valor) {
  const term = document.getElementById('termometro');
  if (valor <= -25) { term.className = 'termometro venda-forte'; term.innerText = 'VENDA FORTE'; }
  else if (valor > -25 && valor <= -8) { term.className = 'termometro venda'; term.innerText = 'VENDA'; }
  else if (valor > -8 && valor <= 8) { term.className = 'termometro neutro'; term.innerText = 'NEUTRO'; }
  else if (valor > 8 && valor <= 25) { term.className = 'termometro compra'; term.innerText = 'COMPRA'; }
  else { term.className = 'termometro compra-forte'; term.innerText = 'COMPRA FORTE'; }
  document.getElementById('classificacao').innerText = term.innerText;
}
</script>

</body>
</html>
