<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Macro Trader</title>
    <!-- Carregar biblioteca oficial -->
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        body { background-color: #121212; color: white; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; }
        .card { background: #1e1e1e; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); width: 90%; max-width: 800px; margin-top: 20px; }
        #clock { font-size: 2.5rem; color: #00ff88; font-family: monospace; margin: 20px 0; text-shadow: 0 0 10px #00ff88; }
        canvas { background-color: #1e1e1e; }
    </style>
</head>
<body>

    <div id="clock">Carregando hora...</div>

    <div class="card">
        <canvas id="macroChart"></canvas>
    </div>

    <script>
        // 1. RELÓGIO BRASÍLIA
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-BR', { 
                timeZone: 'America/Sao_Paulo', 
                hour12: false 
            });
            document.getElementById('clock').innerText = "BRASÍLIA: " + timeString;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // 2. GRÁFICO (Verificação se a biblioteca carregou)
        window.onload = function() {
            if (typeof Chart === 'undefined') {
                alert("Erro: A biblioteca Chart.js não carregou. Verifique sua conexão à internet.");
                return;
            }

            const ctx = document.getElementById('macroChart').getContext('2d');
            const myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Start'],
                    datasets: [{
                        label: 'Mini Índice (WIN) - Simulação Realtime',
                        data: [125000],
                        borderColor: '#00ff88',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true,
                        backgroundColor: 'rgba(0, 255, 136, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { grid: { color: '#333' }, ticks: { color: '#00ff88' } },
                        x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                    },
                    plugins: { legend: { labels: { color: 'white' } } }
                }
            });

            // 3. ATUALIZAÇÃO EM TEMPO REAL (a cada 2 seg)
            setInterval(() => {
                const now = new Date();
                const label = now.toLocaleTimeString('pt-BR', { timeZone: 'America/Sao_Paulo', hour: '2-digit', minute:'2-digit', second:'2-digit' });
                
                // Simulação de volatilidade do mercado
                const lastVal = myChart.data.datasets[0].data[myChart.data.datasets[0].data.length - 1];
                const variation = (Math.random() - 0.5) * 100; 
                const newVal = lastVal + variation;

                myChart.data.labels.push(label);
                myChart.data.datasets[0].data.push(newVal);

                if (myChart.data.labels.length > 10) {
                    myChart.data.labels.shift();
                    myChart.data.datasets[0].data.shift();
                }
                myChart.update('none'); // Update suave
            }, 2000);
        };
    </script>
</body>
</html>
